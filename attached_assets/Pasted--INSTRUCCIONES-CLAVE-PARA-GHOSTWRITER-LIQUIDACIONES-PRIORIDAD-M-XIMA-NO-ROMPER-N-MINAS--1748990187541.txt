
ğŸ“„ INSTRUCCIONES CLAVE PARA GHOSTWRITER â€“ LIQUIDACIONES

ğŸ›‘ PRIORIDAD MÃXIMA: NO ROMPER NÃ“MINAS

âš ï¸ Toda la secciÃ³n de nÃ³mina ya funciona correctamente:
- GeneraciÃ³n de nÃ³minas
- ConfirmaciÃ³n de pagos (por banco, en mano o ambos)
- Registro en historial de pagos
- Registro en payroll_details
- InclusiÃ³n de adiciones y deducciones

ğŸ”’ Esta secciÃ³n queda totalmente cerrada y protegida.
ğŸ‘‰ Bajo ningÃºn concepto debe modificarse la lÃ³gica, columnas, tablas o estructuras ya establecidas para nÃ³mina.

â€”

âœ… NUEVA LÃ“GICA PARA LIQUIDACIONES â€“ CIRCUITO INDEPENDIENTE

1. ğŸ“¦ Tabla nueva sugerida: `liquidation_payments`
   - Estructura propuesta:
     CREATE TABLE liquidation_payments (
       id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
       employee_id UUID NOT NULL,
       amount NUMERIC NOT NULL,
       date DATE NOT NULL,
       concept VARCHAR NOT NULL,
       notes TEXT,
       created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
       updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
     );
  Confirmame si esta estructura te parece que esta ok y la creo en la db.

2. ğŸ” Flujo independiente:
   - Generar liquidaciones:
     - BotÃ³n: "Generar Liquidaciones" (nuevo)
     - Crea registros en `pending_liquidations` si no existen y `processed = false`
   - Ver liquidaciones pendientes:
     - Solo muestra `processed = false`
   - Confirmar pago:
     - Cambia `processed = true` y carga `processed_at = now()`
     - Crea entrada en `liquidation_payments`
   - Historial:
     - Crear una pestaÃ±a aparte del historial de nÃ³mina
     - Mostrar exclusivamente registros de `liquidation_payments`

ğŸš« NO usar ni modificar:
- Tabla payroll_details
- Tabla payroll
- Ninguna tabla compartida con nÃ³mina

â€”

ğŸ¨ AJUSTES ESTÃ‰TICOS SOLICITADOS

âœ… MANTENER:
- BotÃ³n â€œGenerar NÃ³minaâ€
- BotÃ³n â€œRegenerar NÃ³minaâ€ (por ahora)

âŒ ELIMINAR:
- BotÃ³n â€œVolver a diagnÃ³sticoâ€
- PestaÃ±a o vista â€œHerramientasâ€ (si ya no se usa)

ğŸ› ï¸ IMPORTANTE:
Si al hacer estos ajustes hay lÃ³gica o elementos embebidos, se debe revisar cada modificaciÃ³n con extremo cuidado para NO afectar ninguna parte ya funcional.

â€”

ğŸ“Œ RESUMEN FINAL:
- NÃ³minas: cerradas, protegidas, no modificar.
- Liquidaciones: nuevo circuito independiente con su lÃ³gica, tabla y vista separadas.
- Cambios estÃ©ticos: mantener lo Ãºtil, eliminar lo innecesario, siempre con precauciÃ³n.

